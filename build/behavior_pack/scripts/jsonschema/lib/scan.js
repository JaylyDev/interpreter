import*as e from"./helpers.js";class t{static resolve(e,t){const r=e+t;if("resolve:"===r.protocol){const{pathname:e,search:t,hash:i}=r;return e+t+i}return r.toString()}}export function SchemaScanResult(e,t){this.id=e,this.ref=t}export var scan=function(r,i){function n(r,i){if(i&&"object"==typeof i)if(i.$ref){var d=t.resolve(r,i.$ref);f[d]=f[d]?f[d]+1:0}else{var l=i.$id||i.id,c=l?t.resolve(r,l):r;if(c){if(c.indexOf("#")<0&&(c+="#"),a[c]){if(!e.deepCompareStrict(a[c],i))throw new Error("Schema <"+c+"> already exists with different definition");return a[c]}a[c]=i,"#"==c[c.length-1]&&(a[c.substring(0,c.length-1)]=i)}s(c+"/items",Array.isArray(i.items)?i.items:[i.items]),s(c+"/extends",Array.isArray(i.extends)?i.extends:[i.extends]),n(c+"/additionalItems",i.additionalItems),o(c+"/properties",i.properties),n(c+"/additionalProperties",i.additionalProperties),o(c+"/definitions",i.definitions),o(c+"/patternProperties",i.patternProperties),o(c+"/dependencies",i.dependencies),s(c+"/disallow",i.disallow),s(c+"/allOf",i.allOf),s(c+"/anyOf",i.anyOf),s(c+"/oneOf",i.oneOf),n(c+"/not",i.not)}}function s(e,t){if(Array.isArray(t))for(var r=0;r<t.length;r++)n(e+"/"+r,t[r])}function o(e,t){if(t&&"object"==typeof t)for(var r in t)n(e+"/"+r,t[r])}var a={},f={};return n(r,i),new SchemaScanResult(a,f)};